name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.12'
        
    - name: Create static site
      run: |
        # Create a simple static version for GitHub Pages
        mkdir -p public
        cp -r templates public/
        cp -r static public/
        cp README.md public/
        
        # Create a simple index.html that explains this is a demo
        cat > public/index.html << 'EOF'
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Look 4 Fundings - Demo</title>
            <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
        </head>
        <body class="bg-white min-h-screen">
            <div class="max-w-4xl mx-auto py-12 px-4 text-center">
                <h1 class="text-4xl font-bold text-gray-900 mb-4">Look 4 Fundings</h1>
                <p class="text-xl text-gray-600 mb-8">A modern web application for companies to discover and manage funding opportunities</p>
                
                <div class="bg-gray-50 rounded-lg p-8 mb-8">
                    <h2 class="text-2xl font-semibold text-gray-900 mb-4">üöÄ Full-Stack Application</h2>
                    <p class="text-gray-600 mb-6">This is a <strong>FastAPI backend + React frontend</strong> application. GitHub Pages only shows static content, so you're seeing a demo page. The full application requires a backend server.</p>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                        <h3 class="font-semibold text-yellow-800 mb-2">‚ö†Ô∏è Why is this different from local?</h3>
                        <p class="text-yellow-700 text-sm">GitHub Pages hosts static websites only. Your local version runs a Python server with full functionality. This demo page shows what the app does, but you need a backend server to use it.</p>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="bg-white rounded-lg p-4 border">
                            <h3 class="font-semibold text-gray-900 mb-2">Local Development</h3>
                            <code class="text-sm bg-gray-100 p-2 rounded block">uv run python main.py</code>
                        </div>
                        
                        <div class="bg-white rounded-lg p-4 border">
                            <h3 class="font-semibold text-gray-900 mb-2">Features</h3>
                            <ul class="text-left text-gray-600 space-y-1">
                                <li>‚úÖ Grant management with expandable cards</li>
                                <li>‚úÖ Company profile management</li>
                                <li>‚úÖ Sorting and filtering</li>
                                <li>‚úÖ Professional v0-inspired design</li>
                                <li>‚úÖ Responsive layout</li>
                            </ul>
                        </div>
                        
                        <div class="bg-white rounded-lg p-4 border">
                            <h3 class="font-semibold text-gray-900 mb-2">Deploy Full App</h3>
                            <p class="text-gray-600 text-sm mb-3">For the complete experience, deploy to:</p>
                            <div class="space-y-2">
                                <a href="https://railway.app" class="block text-blue-600 hover:text-blue-800 text-sm">üöÇ Railway (Free tier)</a>
                                <a href="https://render.com" class="block text-blue-600 hover:text-blue-800 text-sm">üé® Render (Free tier)</a>
                                <a href="https://vercel.com" class="block text-blue-600 hover:text-blue-800 text-sm">‚ñ≤ Vercel (Free tier)</a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="space-x-4">
                    <a href="https://github.com/MCP4Public/look-4-fundings-front" class="inline-flex items-center px-6 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800">
                        <i class="fab fa-github mr-2"></i>View on GitHub
                    </a>
                    <a href="https://github.com/MCP4Public/look-4-fundings-front#readme" class="inline-flex items-center px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                        <i class="fas fa-book mr-2"></i>Read Documentation
                    </a>
                </div>
            </div>
        </body>
        </html>
        EOF
        
    - name: Setup Pages
      uses: actions/configure-pages@v4
      
    - name: Upload artifact
      uses: actions/upload-pages-artifact@v3
      with:
        path: 'public'
        
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
